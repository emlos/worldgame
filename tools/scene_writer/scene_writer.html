<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Scene writer</title>
    <script>
        const debug = true;
    </script>
    <script type="module" src="../../src/data/data.js"></script>
    <script type="module" src="../../src/classes/classes.js"></script>
    <script type="module" src="../../src/shared/modules.js"></script>
    <style>
        :root {
            --bg: #0b0d10;
            --fg: #e6ecf1;
            --muted: #91a4b1;
            --card: #11161b;
            --line: #26323b;
            --good: #3ddc97;
        }

        html,
        body {
            margin: 0;
            padding: 0;
            background: var(--bg);
            color: var(--fg);
            font: 14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue",
                Arial;
        }

        a {
            color: var(--good);
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        .wrap {
            max-width: 1200px;
            margin: 28px auto;
            padding: 0 16px;
        }

        .top {
            display: flex;
            align-items: baseline;
            justify-content: space-between;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 14px;
        }

        h1 {
            font-size: 18px;
            margin: 0;
        }

        .meta {
            color: var(--muted);
            font-size: 12px;
        }

        .row {
            display: flex;
            flex-direction: row;
            gap: 16px;
        }

        .col {
            display: flex;
            flex-direction: column;
            gap: 16px;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--line);
            border-radius: 14px;
            padding: 16px;
        }

        h2 {
            font-size: 14px;
            margin: 0 0 10px;
        }

        label {
            display: block;
            color: var(--muted);
            font-size: 12px;
            margin: 10px 0 6px;
        }

        input,
        textarea,
        select {
            width: 100%;
            box-sizing: border-box;
            background: #1f2a33;
            color: var(--fg);
            border: 1px solid var(--line);
            padding: 8px 10px;
            border-radius: 10px;
        }

        textarea {
            min-height: 90px;
            resize: vertical;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                "Liberation Mono", "Courier New", monospace;
            font-size: 12px;
        }

        .inline {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            align-items: center;
        }

        .inline>* {
            flex: 1 1 auto;
        }

        .btn {
            background: #1f2a33;
            color: var(--fg);
            border: 1px solid var(--line);
            padding: 8px 10px;
            border-radius: 10px;
            cursor: pointer;
        }

        .btn:hover {
            background: #21323f;
        }

        .btn.small {
            padding: 6px 8px;
            font-size: 12px;
        }

        .btn.danger {
            border-color: #5c2a2a;
        }

        .pill {
            display: inline-block;
            padding: 3px 8px;
            border: 1px solid var(--line);
            border-radius: 999px;
            color: var(--muted);
            font-size: 12px;
        }

        .pill.ok {
            border-color: var(--ok);
            color: #bbf7d0;
        }

        .pill.warn {
            border-color: var(--warn);
            color: #fef9c3;
        }

        .pill.bad {
            border-color: var(--bad);
            color: #fecaca;
        }

        .list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 10px;
        }

        .item {
            border: 1px solid var(--line);
            border-radius: 12px;
            padding: 12px;
        }

        .itemHeader {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 12px;
        }

        .itemHeader strong {
            font-size: 13px;
        }

        .muted {
            color: var(--muted);
        }

        .copyRow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
            margin-top: 8px;
        }

        .copyRow .hint {
            color: var(--muted);
            font-size: 12px;
        }

        pre {
            margin: 0;
            white-space: pre-wrap;
            word-break: break-word;
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas,
                "Liberation Mono", "Courier New", monospace;
            font-size: 12px;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <div class="top">
            <div>
                <h1>Scene writer</h1>
                <div class="meta">
                    Build a scene definition + i18n entries for copy paste into the game code.
                </div>
            </div>
            <div class="meta"><a href="../../index.html">back</a></div>
        </div>

        <div class="row">
            <div class="card" id="editor">
                <h2>Scene</h2>
                <small>Fill in the fields, required are marked with
                    <span style="color: var(--good)">*</span>, output on the right
                </small>

                <!-- Scene basic info -->
                <div>
                    <label>Scene id</label>
                    <input id="sceneId" placeholder="e.g. home.default" />

                    <div class="row">
                        <div>
                            <label>Priority</label>
                            <input id="scenePriority" type="number" step="1" value="1" />
                        </div>
                        <div>
                            <label>Minutes</label>
                            <input id="sceneMinutes" type="number" step="1" value="0" />
                        </div>
                        <div>
                            <label>Auto choices (menu/lobby)</label>
                            <div class="inline" style="gap: 12px">
                                <label style="
                                            margin: 0;
                                            display: flex;
                                            gap: 8px;
                                            align-items: center;
                                            color: var(--fg);
                                        ">
                                    <input id="autoExit" type="checkbox" style="width: auto" />
                                    Exit
                                </label>
                                <label style="
                                            margin: 0;
                                            display: flex;
                                            gap: 8px;
                                            align-items: center;
                                            color: var(--fg);
                                        ">
                                    <input id="autoTraversal" type="checkbox" style="width: auto" />
                                    Traversal
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Scene text -->
                <div>
                    <hr style="border: none; border-top: 1px solid var(--line); margin: 16px 0" />
                    <h2>Text</h2>
                    <div class="col">
                        <div class="row">
                            <div class="meta">
                                <b>Tip: </b>Only default (en) english keys are checked for
                                duplicates
                            </div>
                        </div>
                        <div class="col">
                            <div class="row">
                                <label>Main text key</label>
                                <input id="mainTextKey" placeholder="scene.home.default.text" />
                            </div>
                            <div class="row">
                                <label>Main text content</label>
                                <input id="mainTextContent" placeholder="You're standing in your home" />
                            </div>
                        </div>

                        <div class="col" id="extraTextKeys"></div>
                        <div class="row"> <button class="btn" id="addtextLine">+ line</button>
                            <button class="btn" id="addTextBreak">+ text break</button>
                        </div>


                    </div>
                </div>
                <hr style="border: none; border-top: 1px solid var(--line); margin: 16px 0" />

                <div>
                    <label>Scene conditions (object literal)</label>
                    <textarea id="sceneConditions"></textarea>
                    <br />
                    <div class="inline">
                        <button class="btn small" id="insOutside">outside</button>
                        <button class="btn small" id="insInPlace">inPlace</button>
                        <button class="btn small" id="insNotFlag">notPlayerFlags</button>
                        <button class="btn small" id="insFlag">playerFlags</button>
                    </div>

                    <div class="row">
                        <div>
                            <label>Insert weatherType</label>
                            <div class="inline">
                                <select id="weatherSel">
                                    <!-- <option value="">WeatherType…</option>
                                    <option value="CLEAR">CLEAR</option>
                                    <option value="CLOUDY">CLOUDY</option>
                                    <option value="RAIN">RAIN</option>
                                    <option value="STORM">STORM</option>
                                    <option value="WINDY">WINDY</option>
                                    <option value="SNOW">SNOW</option>
                                    <option value="SUNNY">SUNNY</option> -->
                                </select>
                                <button class="btn small" id="insWeather">insert</button>
                            </div>
                        </div>
                        <div>
                            <label>Insert locationTag</label>
                            <div class="inline">
                                <select id="tagSel">
                                    <!-- <option value="">LOCATION_TAGS…</option>
                                    <option value="rural">rural</option>
                                    <option value="suburban">suburban</option>
                                    <option value="suburban_hub">suburban_hub</option>
                                    <option value="urban">urban</option>
                                    <option value="urban_center">urban_center</option>
                                    <option value="urban_core">urban_core</option>
                                    <option value="urban_edge">urban_edge</option>
                                    <option value="parkland">parkland</option>
                                    <option value="industrial">industrial</option>
                                    <option value="commercial">commercial</option>
                                    <option value="residential">residential</option>
                                    <option value="historic">historic</option>
                                    <option value="tourism">tourism</option>
                                    <option value="education">education</option>
                                    <option value="dense">dense</option>
                                    <option value="coastal">coastal</option>
                                    <option value="wealthy">wealthy</option>
                                    <option value="poor">poor</option> -->
                                </select>
                                <button class="btn small" id="insTag">insert</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card" id="output">
                <h2>Output</h2>
                <div class="meta">Copy/paste these into your scene + i18n files.</div>

                <label>Scene object literal</label>
                <div class="row">
                    <div class="hint">
                        Paste into a <code>SCENES</code> array in a scene pack.
                    </div>
                    <button class="btn small" id="copyScene">Copy</button>
                </div>
                <div class="item" id="jsonOutput"></div>
                <div class="row" id="sceneProblems"></div>

                <hr style="border: none; border-top: 1px solid var(--line); margin: 14px 0" />
                <h2>i18n entries</h2>

                <label>EN</label>
                <div class="row">
                    <div class="hint">
                        Paste into the matching object in <code>src/data/i18n/en/*.js</code>.
                    </div>
                    <button class="btn small" id="copyEn">Copy</button>
                </div>
                <div class="item" id="stringsOutput"></div>
            </div>
        </div>
    </div>
    <script src="./scene_writer.js"></script>
</body>

</html>